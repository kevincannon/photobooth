<!doctype html>
<html>
<head>

	<title>Photobooth: Viewer</title>

	<!-- web app stuff -->
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="viewport" content="initial-scale=1, user-scalable=no">
    <link rel="icon" sizes="192x192" href="img/icon-192.png">

    

	<style type="text/css">

		body {
			padding: 0;
			margin: 0;
			height: auto;
			background-color: #000;

			font-family: Helvetica, sans-serif;
		}

		img {
			border: 1px solid red;
		}

	</style>

	<script src="https://code.jquery.com/jquery-2.1.3.min.js" type="text/javascript"></script>
	<script src="/js/jquery.transit.min.js" type="text/javascript"></script>
	<script src="/js/jquery.transit.min.js" type="text/javascript"></script>

	<script src="/socket.io/socket.io.js"></script>

</head>

<body>

	<img id="image1" src="" height="100" width="100" />
	<!-- <img id="image2" /> -->
 

    <script>
		var onLoadList = [];
		var shownList = [];
		var queuedList = [];


		var socket = io.connect();
		socket.on('fullList', function(data){
		    // console.log("fullList > ");
		    onLoadList = data.split(",");
		    // data.console.log(data);
		    console.log(onLoadList);


		    queuedList = onLoadList.slice(); // copy array
		    showNextImage();	// start
		});

		function showNextImage() {
			var targetImage;

			

			// Load from queue or full list?
			if (queuedList.length >= 1) {
				targetImage = queuedList.pop();
				shownList.push(targetImage);

				console.log("targetImage: " + targetImage);
			} else {
				targetImage = shownList[randomBetween(0, shownList.length-1)];
				console.log("targetImage: " + targetImage);
			}

			console.log("showNextImage: " + queuedList.length + "/" + shownList.length + ":" + targetImage);

			$("#image1").attr("src", targetImage);

			setTimeout(showNextImage, 500)
		}


		function queueImage() {
		
		}


		function randomBetween(min,max)
		{
		    return Math.floor(Math.random()*(max-min+1)+min);
		}

    </script>
    <div>This is our socket.html file</div>
  </body>
</html>